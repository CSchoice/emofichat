import re

# 금융 관련 단어 목록
FINANCE_KEYWORDS = [
    # 금융 상품
    "대출", "적금", "예금", "저축", "계좌", "카드", "신용카드", "체크카드", 
    "이자", "이자율", "대금", "한도", "한도액", "월급", "연봉", "소득",
    "지출", "돈", "금액", "수입", "지불", "갚", "빚", "부채", "연체",
    # 금융 상태 
    "재정", "자산", "부채", "돈 문제", "금융", "경제", "투자", "주식", "펀드", 
    "저축", "연금", "보험", "세금", "납부", "공과금",
    # 감정 상태 + 금융
    "돈 걱정", "돈 불안", "돈 스트레스", "금융 스트레스", "빚 걱정",
    "대출 걱정", "카드값", "카드대금", "연체", "연체료", "연체 이자",
    # 생활비 관련
    "생활비", "주거비", "식비", "교통비", "의료비", "교육비", "통신비",
    "공과금", "관리비", "보험료", "렌트비", "월세", "전세"
]

# 금융 관련 정규식 패턴
FINANCE_PATTERNS = [
    r'\d+만원', r'\d+천원', r'\d+억원',  # 금액 패턴
    r'\d+%', r'\d+ ?퍼센트',            # 퍼센트 패턴
    r'연 ?\d+(?:\.\d+)?%'              # 이자율 패턴
]

def is_finance_topic(message: str) -> bool:
    """
    사용자 메시지가 금융 관련인지 판단
    1) 금융 키워드 포함 여부
    2) 금융 관련 정규식 패턴 매칭
    """
    # 텍스트 전처리
    text = message.lower()
    
    # 1. 금융 키워드 확인
    for keyword in FINANCE_KEYWORDS:
        if keyword in text:
            return True
    
    # 2. 금융 패턴 확인 
    for pattern in FINANCE_PATTERNS:
        if re.search(pattern, text):
            return True
    
    return False
