# 변경 사항 목록

## 2025-04-25

### finance_chat.py 개선

1. **개인화된 재무 캐릭터 모델 도입**
   * 문제점: 기존에는 사용자 재무 지표만으로 조언 생성 → 개인의 성향, 태도, 습관 고려 부족
   * 개선: `infer_user_profile` 함수 추가하여 캐릭터 속성(risk_averse, spending_type, financial_stage) 생성 및 프롬프트에 반영
   * 사용자의 재무 데이터에 기반하여 '재무성향', '금융단계', '스트레스 반응' 등 추론

2. **핵심 지표 강조 유도**
   * 문제점: 기존 user_finance_summary에 단순 나열 → GPT가 '어디에 집중할지' 모호
   * 개선: 중요 지표 강조 지시 추가
   * 핵심 지표: 최근 연체 발생 여부, 잔액 급감/카드사용 급증, 유동성 점수 40 이하

3. **긴급/위험 상태 경고 강화**
   * 개선: 연체 발생 또는 스트레스 지수가 80 초과 시 경고 톤으로 조언하도록 설정
   * 위험 상태일 때 더 신중하고 명확한 경고성 조언 제공 

4. **시나리오 충돌 또는 다중 시나리오 대응**
   * 문제점: 예를 들어 유동성은 좋지만 연체 발생한 경우, 어떤 시나리오를 우선할지 GPT가 혼란
   * 개선: '중복 시나리오 시 우선순위 고려해 작성' 프롬프트 삽입
   * 우선순위 예시: 연체 > 잔액 감소 > 과소비

5. **상담 타입 분기 (정보형 vs 행동형 vs 감정형)**
   * 개선: GPT에게 상담을 3가지 타입으로 분류해서 작성하도록 지시
   * 정보형: "○○란 이런 것이고, 이렇게 관리해야 해요."
   * 행동형: "○○을 꼭 확인하거나 ○○를 신청해보세요."
   * 감정형: "요즘 참 힘드셨죠. 조심스레 추천드리면..."
   * 사용자의 질문 톤이나 시나리오에 따라 자동 분기 유도

6. **코드 구조 개선**
   * `infer_user_profile` 함수와 `build_finance_chat_prompt` 함수를 분리하여 코드 모듈화
   * 기존에 내부 구현되어 있던 로직들을 별도 함수로 분리하여 가독성과 유지보수성 향상
